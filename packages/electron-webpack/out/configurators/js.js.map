{"version":3,"names":["_semver","data","require","createBabelLoader","configurator","presets","default","modules","targets","computeBabelEnvTarget","isRenderer","electronVersion","plugins","type","hasDependency","push","libraryName","styleLibraryName","addBabelItem","getMatchingDevDependencies","includes","excludes","loader","options","to","names","name","module","electron","nodeVersion","gte","node"],"sources":["../../src/configurators/js.ts"],"sourcesContent":["import { gte } from \"semver\"\nimport { WebpackConfigurator } from \"../main\"\n\nexport function createBabelLoader(configurator: WebpackConfigurator) {\n  // better to use require instead of just preset name to avoid babel resolving (in our test we set custom resolver - and only in case of explicit required it works)\n  const presets = [\n    [\n      require(\"@babel/preset-env\").default, {\n      modules: false,\n      targets: computeBabelEnvTarget(configurator.isRenderer, configurator.electronVersion),\n    }],\n  ]\n  const plugins = [\n    require(\"@babel/plugin-syntax-dynamic-import\").default,\n  ]\n\n  if (configurator.type !== \"main\" && configurator.hasDependency(\"element-ui\")) {\n    plugins.push([require(\"babel-plugin-component\"), {\n      libraryName: \"element-ui\",\n      styleLibraryName: \"theme-chalk\"\n    }])\n  }\n\n  addBabelItem(presets, configurator.getMatchingDevDependencies({\n    includes: [\"babel-preset-\", \"@babel/preset-\"],\n    excludes: [\"babel-preset-env\", \"@babel/preset-env\"],\n  }))\n  addBabelItem(plugins, configurator.getMatchingDevDependencies({\n    includes: [\"babel-plugin-\", \"@babel/plugin-\"],\n    excludes: [\"babel-plugin-syntax-dynamic-import\", \"@babel/plugin-syntax-dynamic-import\"],\n  }))\n\n  return {\n    loader: \"babel-loader\",\n    options: {\n      presets,\n      plugins\n    }\n  }\n}\n\nfunction addBabelItem(to: Array<any>, names: Array<string>) {\n  for (const name of names) {\n    const module = require(name)\n    to.push([module.default || module])\n  }\n}\n\nfunction computeBabelEnvTarget(isRenderer: boolean, electronVersion: string) {\n  if (isRenderer) {\n    return {\n      electron: electronVersion\n    }\n  }\n\n  let nodeVersion = \"7.4.0\"\n  if (gte(electronVersion, \"3.0.0\")) {\n    nodeVersion = \"10.2.0\"\n  }\n  else if (gte(electronVersion, \"2.0.0\")) {\n    nodeVersion = \"8.9.3\"\n  }\n  else if (gte(electronVersion, \"1.8.2\")) {\n    nodeVersion = \"8.2.1\"\n  }\n  else if (gte(electronVersion, \"1.7.3\")) {\n    nodeVersion = \"7.9.0\"\n  }\n\n  return {\n    node: nodeVersion\n  }\n}\n"],"mappings":";;;;;;AAAA,SAAAA,QAAA;EAAA,MAAAC,IAAA,GAAAC,OAAA;EAAAF,OAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAGM,SAAUE,iBAAiBA,CAACC,YAAiC;EACjE;EACA,MAAMC,OAAO,GAAG,CACd,CACEH,OAAO,CAAC,mBAAmB,CAAC,CAACI,OAAO,EAAE;IACtCC,OAAO,EAAE,KAAK;IACdC,OAAO,EAAEC,qBAAqB,CAACL,YAAY,CAACM,UAAU,EAAEN,YAAY,CAACO,eAAe;GACrF,CAAC,CACH;EACD,MAAMC,OAAO,GAAG,CACdV,OAAO,CAAC,qCAAqC,CAAC,CAACI,OAAO,CACvD;EAED,IAAIF,YAAY,CAACS,IAAI,KAAK,MAAM,IAAIT,YAAY,CAACU,aAAa,CAAC,YAAY,CAAC,EAAE;IAC5EF,OAAO,CAACG,IAAI,CAAC,CAACb,OAAO,CAAC,wBAAwB,CAAC,EAAE;MAC/Cc,WAAW,EAAE,YAAY;MACzBC,gBAAgB,EAAE;KACnB,CAAC,CAAC;;EAGLC,YAAY,CAACb,OAAO,EAAED,YAAY,CAACe,0BAA0B,CAAC;IAC5DC,QAAQ,EAAE,CAAC,eAAe,EAAE,gBAAgB,CAAC;IAC7CC,QAAQ,EAAE,CAAC,kBAAkB,EAAE,mBAAmB;GACnD,CAAC,CAAC;EACHH,YAAY,CAACN,OAAO,EAAER,YAAY,CAACe,0BAA0B,CAAC;IAC5DC,QAAQ,EAAE,CAAC,eAAe,EAAE,gBAAgB,CAAC;IAC7CC,QAAQ,EAAE,CAAC,oCAAoC,EAAE,qCAAqC;GACvF,CAAC,CAAC;EAEH,OAAO;IACLC,MAAM,EAAE,cAAc;IACtBC,OAAO,EAAE;MACPlB,OAAO;MACPO;;GAEH;AACH;AAEA,SAASM,YAAYA,CAACM,EAAc,EAAEC,KAAoB;EACxD,KAAK,MAAMC,IAAI,IAAID,KAAK,EAAE;IACxB,MAAME,MAAM,GAAGzB,OAAO,CAACwB,IAAI,CAAC;IAC5BF,EAAE,CAACT,IAAI,CAAC,CAACY,MAAM,CAACrB,OAAO,IAAIqB,MAAM,CAAC,CAAC;;AAEvC;AAEA,SAASlB,qBAAqBA,CAACC,UAAmB,EAAEC,eAAuB;EACzE,IAAID,UAAU,EAAE;IACd,OAAO;MACLkB,QAAQ,EAAEjB;KACX;;EAGH,IAAIkB,WAAW,GAAG,OAAO;EACzB,IAAI,IAAAC,aAAG,EAACnB,eAAe,EAAE,OAAO,CAAC,EAAE;IACjCkB,WAAW,GAAG,QAAQ;GACvB,MACI,IAAI,IAAAC,aAAG,EAACnB,eAAe,EAAE,OAAO,CAAC,EAAE;IACtCkB,WAAW,GAAG,OAAO;GACtB,MACI,IAAI,IAAAC,aAAG,EAACnB,eAAe,EAAE,OAAO,CAAC,EAAE;IACtCkB,WAAW,GAAG,OAAO;GACtB,MACI,IAAI,IAAAC,aAAG,EAACnB,eAAe,EAAE,OAAO,CAAC,EAAE;IACtCkB,WAAW,GAAG,OAAO;;EAGvB,OAAO;IACLE,IAAI,EAAEF;GACP;AACH"}
